<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, user-scalable=yes" />
	<title>Cosmos: The infographic book of space</title>
	<link rel="stylesheet" href="../style.css" />
	<style>
	/* CSS3 Animations */
	#space {
		width: 100%;
		height: 90%;
		position: absolute;
		left: 0px;
		right: 0px;
		top: 0px;
		bottom: 0px;
	}
	.middlebox {
		position: absolute;
		left: 2em;
		right: 2em;
		top: 1em;
		bottom: 2em;		
	}
	.innerbox {
		position: absolute;
		left: 0em;
		right: 0em;
		top: 4.5em;
		bottom: 0em;		
	}
	.middlebox ul { margin-top: 0.5em; margin-bottom: 0.5em; }
	ul { list-style: none; margin-left: 0px; padding-left: 0; }
	ul li { display: inline-block; margin-right: 1em; }
	.human {
		width: 0.8em;
		height: 0.8em;
		display: inline-block;
		border-radius: 1em;
		z-index: 1;
		cursor: pointer;
	}
	.innerbox .human {
		position: absolute;
		left: 0px;
		top: 0px;
		display: block;
	    background-image: url('astronaut.png');
	    background-size: auto 60%, auto;
	    background-repeat:no-repeat;
		background-position: 0.5em center;
	}
	.innerbox .human.selected { /*border: 4px solid black; left: -4px; margin-top: -4px;*/ background-color: black; }
	
	.stripe { width: 100%; height: 4px; }

	label { display: none; }
	.xaxis,.data { position: absolute; top: 0px; width: 100%; height: 100%; overflow: hidden; }
	.yaxis { position: absolute; left: 0px; width: 100%; height: 100%; overflow: hidden; }
	.xaxis .gridline, .yaxis .gridline { border: 1px solid #fdcc9c; }
	.xaxis .gridline {
		position: absolute;
		top: 0px;
		border-right: 0px;
		border-top: 0px;
		border-bottom: 0px;
		height: 100%;
	}
	.yaxis .gridline {
		position: absolute;
		left: 0px;
		border-right: 0px;
		border-left: 0px;
		border-bottom: 0px;
		width: 100%;
	}
	.xaxis .majorgridline,.yaxis .majorgridline { border-color: white; border-width: 2px; }
	.xaxis .label { bottom: 0px; margin: 0.25em; margin-bottom: 0; line-height: 1em; }
	.yaxis .label { right: 0px; margin: 0.25em; margin-right: 0; line-height: 1em; }
	.xaxis .label, .yaxis .label { color: #fbb675; position: absolute; white-space: nowrap; }
	.xaxis .label:hover, .yaxis .label:hover { color: black; }

	h1 { margin-top: 0.5em; }
	.middlebox { display: table; width: 100%; height: 100%; left: 0px; right: 0px; top: 0px; bottom: 0px; }
	.topbox { display: table-row; margin: 1em; padding-top: 1em; }
	.innerbox { display: table-row; margin: 2em; overflow-x: scroll; }
	
	#timeline { width: 8000px; position: absolute; height: 100%; }

	@media only screen and (max-width: 700px){
		.topbox ul { font-size: 0.8em; }
		select { font-size: 0.8em; }
	}

	</style>
	<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="../infographics.js"></script>
	<script type="text/javascript">

	$(document).ready(function(){

		var astronauts = new Array();
		var xaxis;
		var yaxis;
		var cc = {'ABW':'Aruba','AFG':'Afghanistan','AGO':'Angola','AIA':'Anguilla','ALA':'&Aring;land Islands','ALB':'Albania','AND':'Andorra','ARE':'United Arab Emirates','ARG':'Argentina','ARM':'Armenia','ASM':'American Samoa','ATA':'Antarctica','ATF':'French Southern Territories','ATG':'Antigua and Barbuda','AUS':'Australia','AUT':'Austria','AZE':'Azerbaijan','BDI':'Burundi','BEL':'Belgium','BEN':'Benin','BES':'Bonaire, Sint Eustatius and Saba','BFA':'Burkina Faso','BGD':'Bangladesh','BGR':'Bulgaria','BHR':'Bahrain','BHS':'Bahamas','BIH':'Bosnia and Herzegovina','BLM':'Saint Barthélemy','BLR':'Belarus','BLZ':'Belize','BMU':'Bermuda','BOL':'Bolivia, Plurinational State of','BRA':'Brazil','BRB':'Barbados','BRN':'Brunei Darussalam','BTN':'Bhutan','BVT':'Bouvet Island','BWA':'Botswana','CAF':'Central African Republic','CAN':'Canada','CCK':'Cocos (Keeling) Islands','CHE':'Switzerland','CHL':'Chile','CHN':'China','CIV':'Côte d\'Ivoire','CMR':'Cameroon','COD':'Congo, the Democratic Republic of the','COG':'Congo','COK':'Cook Islands','COL':'Colombia','COM':'Comoros','CPV':'Cabo Verde','CRI':'Costa Rica','CUB':'Cuba','CUW':'Curaçao','CXR':'Christmas Island','CYM':'Cayman Islands','CYP':'Cyprus','CZE':'Czech Republic','DEU':'Germany','DJI':'Djibouti','DMA':'Dominica','DNK':'Denmark','DOM':'Dominican Republic','DZA':'Algeria','ECU':'Ecuador','EGY':'Egypt','ERI':'Eritrea','ESH':'Western Sahara','ESP':'Spain','EST':'Estonia','ETH':'Ethiopia','FIN':'Finland','FJI':'Fiji','FLK':'Falkland Islands (Malvinas)','FRA':'France','FRO':'Faroe Islands','FSM':'Micronesia, Federated States of','GAB':'Gabon','GBR':'United Kingdom','GEO':'Georgia','GGY':'Guernsey','GHA':'Ghana',	'GIB':'Gibraltar','GIN':'Guinea','GLP':'Guadeloupe','GMB':'Gambia','GNB':'Guinea-Bissau','GNQ':'Equatorial Guinea','GRC':'Greece','GRD':'Grenada','GRL':'Greenland','GTM':'Guatemala','GUF':'French Guiana','GUM':'Guam','GUY':'Guyana','HKG':'Hong Kong','HMD':'Heard Island and McDonald Islands','HND':'Honduras','HRV':'Croatia','HTI':'Haiti','HUN':'Hungary','IDN':'Indonesia','IMN':'Isle of Man','IND':'India','IOT':'British Indian Ocean Territory','IRL':'Ireland','IRN':'Iran, Islamic Republic of','IRQ':'Iraq','ISL':'Iceland','ISR':'Israel','ITA':'Italy','JAM':'Jamaica','JEY':'Jersey','JOR':'Jordan','JPN':'Japan','KAZ':'Kazakhstan','KEN':'Kenya','KGZ':'Kyrgyzstan','KHM':'Cambodia','KIR':'Kiribati','KNA':'Saint Kitts and Nevis','KOR':'Korea, Republic of','KWT':'Kuwait','LAO':'Lao People\'s Democratic Republic','LBN':'Lebanon','LBR':'Liberia','LBY':'Libya','LCA':'Saint Lucia','LIE':'Liechtenstein','LKA':'Sri Lanka','LSO':'Lesotho','LTU':'Lithuania','LUX':'Luxembourg','LVA':'Latvia','MAC':'Macao','MAF':'Saint Martin (French part)','MAR':'Morocco','MCO':'Monaco','MDA':'Moldova, Republic of','MDG':'Madagascar','MDV':'Maldives','MEX':'Mexico','MHL':'Marshall Islands','MKD':'Macedonia, the former Yugoslav Republic of','MLI':'Mali','MLT':'Malta','MMR':'Myanmar','MNE':'Montenegro','MNG':'Mongolia','MNP':'Northern Mariana Islands','MOZ':'Mozambique','MRT':'Mauritania','MSR':'Montserrat','MTQ':'Martinique','MUS':'Mauritius','MWI':'Malawi','MYS':'Malaysia','MYT':'Mayotte','NAM':'Namibia','NCL':'New Caledonia','NER':'Niger','NFK':'Norfolk Island','NGA':'Nigeria','NIC':'Nicaragua','NIU':'Niue',	'NLD':'Netherlands','NOR':'Norway','NPL':'Nepal','NRU':'Nauru','NZL':'New Zealand','OMN':'Oman','PAK':'Pakistan','PAN':'Panama','PCN':'Pitcairn','PER':'Peru','PHL':'Philippines','PLW':'Palau','PNG':'Papua New Guinea','POL':'Poland','PRI':'Puerto Rico','PRK':'Korea, Democratic People\'s Republic of','PRT':'Portugal','PRY':'Paraguay','PSE':'Palestine, State of','PYF':'French Polynesia','QAT':'Qatar','REU':'Réunion','ROU':'Romania','RUS':'Russian Federation','RWA':'Rwanda','SAU':'Saudi Arabia','SDN':'Sudan','SEN':'Senegal','SGP':'Singapore','SGS':'South Georgia and the South Sandwich Islands','SHN':'Saint Helena, Ascension and Tristan da Cunha','SJM':'Svalbard and Jan Mayen','SLB':'Solomon Islands','SLE':'Sierra Leone','SLV':'El Salvador','SMR':'San Marino','SOM':'Somalia','SPM':'Saint Pierre and Miquelon','SRB':'Serbia','SSD':'South Sudan','STP':'Sao Tome and Principe','SUR':'Suriname','SVK':'Slovakia','SVN':'Slovenia','SWE':'Sweden','SWZ':'Swaziland','SXM':'Sint Maarten (Dutch part)','SYC':'Seychelles','SYR':'Syrian Arab Republic','TCA':'Turks and Caicos Islands','TCD':'Chad','TGO':'Togo','THA':'Thailand','TJK':'Tajikistan','TKL':'Tokelau','TKM':'Turkmenistan','TLS':'Timor-Leste','TON':'Tonga','TTO':'Trinidad and Tobago','TUN':'Tunisia','TUR':'Turkey','TUV':'Tuvalu','TWN':'Taiwan, Province of China','TZA':'Tanzania, United Republic of','UGA':'Uganda','UKR':'Ukraine','UMI':'United States Minor Outlying Islands','URY':'Uruguay','USA':'United States','UZB':'Uzbekistan','VAT':'Holy See (Vatican City State)','VCT':'Saint Vincent and the Grenadines','VEN':'Venezuela, Bolivarian Republic of','VGB':'Virgin Islands, British','VIR':'Virgin Islands, U.S.','VNM':'Viet Nam','VUT':'Vanuatu','WLF':'Wallis and Futuna','WSM':'Samoa','YEM':'Yemen','ZAF':'South Africa','ZMB':'Zambia','ZWE':'Zimbabwe','URS':'Soviet Union','GDR':'East Germany','TCH':'Czechoslovakia'};


		function parseIt(data){

			var launch,land;
			var html = "";
			var start = new Date('1961-01-01T00:00:00Z');
			var end = new Date('2014-01-01T00:00:00Z');
			var now = new Date();
			end = new Date();
			var tmp = new Date();
			tmp.setMonth(0);
			tmp.setDate(1);
			var yfrac = (now-tmp)/(86400000*365.25);

			$('.innerbox').append('<div id="timeline"><\/div>');

			var scale = 1/(end-start);
			var w = $('.human').outerWidth();
			var wide = $('#timeline').width();
			var tall = $('#timeline').height();
			
			var pixels = new Array(wide);
			for(px = 0; px < wide ; px++) pixels[px] = new Array(20);

			var nmax = 0;

			for(name in data) {
				for(var m = 0; m < data[name].periods.length; m++){
					var ms = data[name].periods[m].split(/;/);
					launch = (ms[0]) ? new Date(ms[0]) : "BLAH";
					land = (ms[1]) ? new Date(ms[1]) : new Date();
					l = Math.floor((launch-start)*scale*wide);
					dl = Math.ceil((land-launch)*scale*wide);
					var n = 0;
					// Find level to fill
					for(var i = l ; i < l + dl ; i++){
						for(var j = 0; j < pixels[i].length; j++){
							if(pixels[i][j] && j >= n){
								n = j+1;
							}
						}
					}
					for(var i = l ; i < l + dl ; i++) pixels[i][n] = true;
					var nmax = 0;
					for(var i = 0 ; i < pixels.length ; i++){
						if(pixels[i].length > nmax) nmax = pixels[i].length;
					}
					// Make a copy of the object
					var a = JSON.parse(JSON.stringify(data[name]));
					a.name = name;
					a.n = n;
					a.width = dl;
					a.left = l;
					a.launch = launch;
					a.land = (ms[1] ? land : "");
					a.dob = new Date(a.dob);
					astronauts.push(a);
				}
			}
			for(var a = 0 ; a < astronauts.length; a++) html += '<div class="human '+astronauts[a].category+'" id="'+a+'" style="top:'+((astronauts[a].n/nmax)*96)+'%;width:'+astronauts[a].width+'px;margin-left:'+astronauts[a].left+'px;height:'+(80/nmax)+'%;" title="'+astronauts[a].name+'"><\/div>'

			$('#timeline').append('<div class="data">'+html+'<\/div>');
			$('#timeline').append('<div class="xaxis">'+makeGridLines(end.getUTCFullYear()+yfrac,start.getUTCFullYear())+'<\/div>');
	
			function formatArray(str,lookup){
				// Split into array
				var arr = (typeof str==="string") ? str.split(/;/) : str;
				str = "";
				for(var i = 0 ; i < arr.length; i++){
					if(str) str += ", ";
					if(lookup) str += lookup[arr[i]];
					else str += arr[i];
				}
				return str;
			}

			// Set up the tooltip
			tooltip({
				'elements':$('.human'),
				'html':function(){
					$('.human').removeClass('selected')
					var id = parseInt($(this).attr('id'));
					$('.human[title="'+$(this).attr('title')+'"').addClass('selected');
					var a = astronauts[id];
					var text = '<div class="stripe '+a.category+'"><\/div><h3>'+a.name+'<\/h3><table>';
					text += '<tr><td>Gender:<\/td><td>'+a.gender+'<\/td><\/tr>';
					text += '<tr><td>Country:<\/td><td>'+formatArray(a.country,cc)+'<\/td><\/tr>';
					text += '<tr><td>Year of birth:<\/td><td>'+a.dob.getFullYear()+'<\/td><\/tr>';
					text += '<tr><td>Trips to space:<\/td><td>'+a.periods.length+'<\/td><\/tr>';
					text += '<tr><td>This mission:<\/td><td>'+a.launch.toLocaleDateString()+' - '+(a.land ? a.land.toLocaleDateString() : '')+'<\/td><\/tr>';
					text += '<\/table>';
					text += '<a href="https://github.com/cosmos-book/cosmos-book.github.io/tree/master/humanspaceflight/data/'+a.file+'" class="repo">data file<\/a>';
					return text;
				}
			});
			
			// We can hide the loader/spinner as everything seems to be OK
			$('.loader').hide();
		}

		// Load the data file
		loadJSON(getDataPath('#data'),parseIt,{error:function(){ $('.loader').html("Oops. Couldn't find the data."); }});

		// If we click elsewhere we will deselect the astronaut
		$(document).on('click',function(e){ $('.human').removeClass('selected'); $('.tooltip_close').trigger('click') });
		
		// Hide any non-Javascript elements
		$('.noscript').hide();

		function makeGridLines(mx,mn){
			var html = "";
			var x;

			// The age at first launch with a grid spacing of 1 year
			var step = 1;
			var a = Math.ceil(mn/step)*step;
			var b = Math.floor(mx/step)*step;
			for(var i = a; i <= b; i+=step){
				html += '<div class="gridline" style="'+'left:'+(100*((i-mn)/(mx-mn)))+'%"><span class="label">'+(i)+'<\/span><\/div>';
			}

			return html;
		}

	})
	</script>
</head>
<body class="EXP">

<div class="outerbox">
	<div class="middlebox">
		<div class="topbox">
			<h1>A timeline of people in space</h1>
			<ul>
				<li><span class="human cosmonaut"></span> Soviet/Russian cosmonauts</li>
				<li><span class="human astronaut"></span> US astronauts</li>
				<li><span class="human taikonaut"></span> Chinese taikonauts</li>
				<li><span class="human international"></span> International astronauts</li>
				<li><span class="human tourist"></span> Space tourists</li>
			</ul>
		</div>
		<div class="innerbox">
			<div class="noscript">
				<p>This is an interactive version of the <a href="https://github.com/cosmos-book/cosmos-book.github.io/blob/master/humanspaceflight/data/processed/astronauts.json" id="data">data file</a></p>
			</div>
			<div class="loader"><div class="bounce"></div><div class="bounce"></div><div class="bounce"></div></div>
		</div>
	</div>
	<div class="footer">Part of <a href="../index.html">Cosmos<span class="wide">: The Infographic Book of Space</span></a> by <a href="https://twitter.com/astronomyblog">Stuart Lowe</a> & <a href="https://twitter.com/chrisenorth">Chris North</a></div>
</div>
</body>
</html>